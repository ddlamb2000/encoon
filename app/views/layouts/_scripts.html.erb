<script>  $(document).ready(function(){    <% unless @grid.nil? or @row.nil? %>      <% unless @attached_grids.nil? or @attached_grids.empty? %>        <% for attached_grid in @attached_grids %>          <% filters = attached_grid.get_filters_on_row(@row) %>          $("#grid-<%= attached_grid.uuid + "-" + get_filters_uuid(filters) %>").load(            "<%= url_for(list_path(:grid => attached_grid.uuid,                                   :filters => filters)) %>");        <% end %>      <% end %>    <% end %>    function showNavigator(updateFlag) {      if ($("#navigator-button").attr('checked')) {        if(updateFlag) {          $.ajax("<%= url_for(unset_path(:flag => "hide_navigator")) %>");        }        $("#navigator").show(300);        $("#main-area").removeClass("large-area").addClass("main-area");      }       else {        $("#navigator").hide(300);        $("#main-area").removeClass("main-area").addClass("large-area");        if(updateFlag) {          $.ajax("<%= url_for(set_path(:flag => "hide_navigator")) %>");        }      }    };    showNavigator(false);    $("#navigator-button").click(function (event){      showNavigator(true);    });    <% if session[:history_table].present? %>      function showHistory(updateFlag) {        if ($("#history-button").attr('checked')) {          $("#history-content").            html('<%= escape_javascript(render :partial => "layouts/loading") %>').            show(300).            load("<%= url_for(history_path) %>");          $("#history-title").addClass("highlighted");        }         else {          $("#history-title").removeClass("highlighted");          $("#history-content").hide(300);          if(updateFlag) {            $.ajax("<%= url_for(unset_path(:flag => "show_history")) %>");          }        }      };      showHistory(false);      $("#history-button").click(function (event){        showHistory(true);      });    <% end %>    <% unless not user_signed_in? or @grid.nil? or @row.nil? %>      function showDetails(updateFlag) {        if ($("#more-button").attr('checked')) {          $("#more-content").            html('<%= escape_javascript(render :partial => "layouts/loading") %>').            show(300).            load("<%= url_for(details_path(:grid => @grid.uuid,                                           :row => @row.uuid)) %>");          $("#more-title").addClass("highlighted");        }         else {          $("#more-title").removeClass("highlighted");          $("#more-content").hide(300);          if(updateFlag) {            $.ajax("<%= url_for(unset_path(:flag => "show_details")) %>");          }        }      };      showDetails(false);      $("#more-button").click(function (event){        showDetails(true);      });    <% end %>    $('a.disabled').live('click', function(event){        event.preventDefault();    });  });</script>
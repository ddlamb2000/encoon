<ul>  <% if @grid.uuid != GRID_UUID %>    <% for column in @table_columns %>      <% value = @row.read_value(column) %>      <% if column.workspace_reference.present? and column.grid_reference.present? and value.present? %>        <li>          <% reference_information = @row.read_referenced_name_and_description(column, value) %>          <%= link_to(reference_information[0], show_path(                                       :workspace => column.workspace_reference.display_uri,                                       :grid => column.grid_reference.display_uri,                                       :row => value)) %>          <small><%= column %></small>        </li>      <% end %>    <% end %>  <% end %>  <% unless @grid.nil? or @row.nil? or @attached_grids.nil? or @attached_grids.empty? %>    <% displayed_count = 0 %>    <% for attached_grid in @attached_grids %>      <% filters = attached_grid.get_filters_on_row(@row, @grid.row_title(@row)) %>      <% displayed = (session[:hide_navigator] or @attached_grids.count == 1 or session[filters_uuid(attached_grid, filters)]) %>      <% displayed_count += 1 if displayed %>    <% end %>    <% for attached_grid in @attached_grids %>      <% filters = attached_grid.get_filters_on_row(@row, @grid.row_title(@row)) %>      <% displayed = (displayed_count == 0 or session[:hide_navigator] or @attached_grids.count == 1 or session[filters_uuid(attached_grid, filters)]) %>      <% displayed_count += 1 if displayed %>      <li id="detail-grid-<%= filters_uuid(attached_grid, filters) %>">        <span class="button table-button">          <a id="detail-grid-label-<%= filters_uuid(attached_grid, filters) %>"><%= attached_grid.name %></a>        </span>        <% if attached_grid.filter_column_name.present? and attached_grid.filter_column_name != @grid.to_s %>          <small>(<%= attached_grid.filter_column_name %>)</small>        <% end %>        <div class="slideButton">          <input type="checkbox"                 id="grid-button-<%= filters_uuid(attached_grid, filters) %>"                 <%= displayed ? 'checked' : '' %> />          <label for="grid-button-<%= filters_uuid(attached_grid, filters) %>"></label>        </div>      </li>      <script>        $("#detail-grid-<%= filters_uuid(attached_grid, filters) %>").hover(          function (event){            $("#grid-<%= filters_uuid(attached_grid, filters) %>").addClass("highlighted");          },          function (event){            $("#grid-<%= filters_uuid(attached_grid, filters) %>").removeClass("highlighted");          }        );        $("#grid-button-<%= filters_uuid(attached_grid, filters) %>").click(function (event){          showTable("<%= url_for(list_path(:grid => attached_grid.uuid, :filters => filters)) %>",                    "<%= filters_uuid(attached_grid, filters) %>",                    true);        });        $("#detail-grid-label-<%= filters_uuid(attached_grid, filters) %>").click(function (event){          $("#grid-button-<%= filters_uuid(attached_grid, filters) %>").attr('checked',            !$("#grid-button-<%= filters_uuid(attached_grid, filters) %>").attr('checked'));          showTable("<%= url_for(list_path(:grid => attached_grid.uuid, :filters => filters)) %>",                    "<%= filters_uuid(attached_grid, filters) %>",                    true);        });        $(document).ready(function(){          showTable("<%= url_for(list_path(:grid => attached_grid.uuid, :filters => filters)) %>",                    "<%= filters_uuid(attached_grid, filters) %>",                    "<%= displayed %>");        });      </script>    <% end %>  <% end %></ul>
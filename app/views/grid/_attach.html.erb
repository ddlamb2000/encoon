<header class="action-header"><%= @workspace %> Â» <%= @grid %></header>
<%= form_tag(save_attachment_path(:grid => @grid.uuid, :row => @row.uuid),
             :multipart => true,
             :target => "target-dialog",
             :id => 'attach-form') do %>
  <table class="form">
    <tr>
      <td class="header"><%= t 'field.file' %></td>
      <td class="string"><%= file_field_tag :document %></td>
    </tr>
  </table>
  <footer class="actions">
    <span class="button"><a id="cancel-dialog"><%= t 'actions.cancel' %></a></span>
    <span class="button"><%= submit_tag t('actions.attach'), :id => "ok-dialog" %></span>
  </footer>
<% end %>
<iframe id="target-dialog"></iframe>
<script>
  $("#cancel-dialog").click(function (event){
    $("#document, #document article").removeClass("disabled");
    $("a").attr('class', 'enabled');
    $("#dialog").hide(300);
  });
  $("#target-dialog").bind("load", function (event){
    $("body:contains(required)").css("background-color","red");
    $("#attachments-<%= @row.uuid %>").load("<%= url_for(attachments_path(:grid => @grid.uuid,
                                                                          :row => @row.uuid)) %>");
    if ($("#more-button").attr('checked')) {
      $("#more-content").load("<%= url_for(details_path(:grid => @grid.uuid,
                                                        :row => @row.uuid)) %>");
    }
  });
</script>